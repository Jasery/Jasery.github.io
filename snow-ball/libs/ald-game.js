!function(){function e(e,t){d++,e.as=w,e.at=p,e.rq_c=d,e.ifo=o,e.ak=s.app_key,e.uu=i,e.v=r,e.st=Date.now(),e.ev=t,e.wsr=h,e.ufo=function(e){if(void 0===e||""===e)return"";var t={};for(var n in e)"rawData"!=n&&"errMsg"!=n&&(t[n]=e[n]);return t}(e.ufo),e.ec=l,wx.Queue.push(function(){return new Promise(function(t,n){wx.request({url:"https://"+a+".aldwx.com/d.html",data:e,header:{se:u||"",op:f||"",img:y||""},method:"GET",success:function(){t("")},fail:function(){t("")}})})})}function t(e){var t={};for(var n in e)t[n]=e[n];return t}function n(e){for(var t="",n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);return t}wx.Queue=new function(){this.concurrency=5,this.queue=[],this.tasks=[],this.activeCount=0;var e=this;this.push=function(t){this.tasks.push(new Promise(function(n,r){var a=function(){e.activeCount++,t().then(function(e){n(e)}).then(function(){e.next()})};e.activeCount<e.concurrency?a():e.queue.push(a)}))},this.all=function(){return Promise.all(this.tasks)},this.next=function(){e.activeCount--,e.queue.length>0&&e.queue.shift()()}},wx.Queue.all();var r="1.0.0",a="glog",s=require("./ald-game-conf");""===s.app_key&&console.error("请在配置文件中填写您的app_key"),s.app_key=s.app_key.replace(/\s/g,""),wx.request({url:"https://"+a+".aldwx.com/config/app.json",method:"GET",success:function(e){200===e.statusCode&&(e.data.version!=r&&console.warn("您的SDK不是最新版本，请尽快升级！"),e.data.warn&&console.warn(e.data.warn),e.data.error&&console.error(e.data.error))}});var o="",i=function(){var e="";try{e=wx.getStorageSync("aldstat_uuid"),wx.setStorageSync("ald_ifo",!0)}catch(t){e="uuid_getstoragesync"}if(e)o=!1;else{e=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}(),o=!0;try{wx.setStorageSync("aldstat_uuid",e)}catch(e){wx.setStorageSync("aldstat_uuid","uuid_getstoragesync")}}return e}(),c={},u="",f="",l=0,d="",h=wx.getLaunchOptionsSync(),g=Date.now(),p=""+Date.now()+Math.floor(1e7*Math.random()),w=""+Date.now()+Math.floor(1e7*Math.random()),_=0,v="",y="",S=!0,x=["aldSendEvent","aldOnShareAppMessage","aldShareAppMessage","aldSendSession","aldSendOpenid"];Promise.all([new Promise(function(e,t){wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){y=n(t.userInfo.avatarUrl.split("/")),e(t)},fail:function(){e("")}}):e("")},fail:function(){e("")}})}),new Promise(function(e,t){wx.getNetworkType({success:function(t){e(t)},fail:function(){e("")}})}),new Promise(function(e,t){s.getLocation?wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}):wx.getSetting({success:function(t){t.authSetting["scope.userLocation"]?(wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}),e("")):e("")},fail:function(){e("")}})})]).then(function(n){""!==n[2]?(c.lat=n[2].latitude||"",c.lng=n[2].longitude||"",c.spd=n[2].speed||""):(c.lat="",c.lng="",c.spd=""),""!==n[1]?c.nt=n[1].networkType||"":c.nt="";var r=t(c);""!==n[0]&&(r.ufo=n[0],v=n[0]),e(r,"init")}),wx.onShow(function(n){d=0,h=n,_=Date.now(),S||(p=""+Date.now()+Math.floor(1e7*Math.random()),o=!1,wx.setStorageSync("ald_ifo",!1)),S=!1;var r=t(c),a=t(c);r.sm=_-g,n.query.ald_share_src&&n.shareTicket&&"1044"===n.scene?(a.tp="ald_share_click",new Promise(function(e,t){"1044"==h.scene?wx.getShareInfo({shareTicket:h.shareTicket,success:function(t){e(t)},fail:function(){e("")}}):e("")}).then(function(t){a.ct=t,e(a,"event")})):n.query.ald_share_src&&(a.tp="ald_share_click",a.ct="1",e(a,"event")),e(r,"show")}),wx.onHide(function(){var r=t(c);r.dr=Date.now()-_,""===v?wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){r.ufo=t,v=t,y=n(t.userInfo.avatarUrl.split("/")),e(r,"hide")}}):e(r,"hide")}}):e(r,"hide")}),wx.onError(function(n){var r=t(c);r.tp="ald_error_message",r.ct=n,l++,e(r,"event")});for(var m={aldSendEvent:function(n,r){var a=t(c);""!==n&&"string"==typeof n&&n.length<=255?(a.tp=n,"string"==typeof r&&r.length<=255?(a.ct=String(r),e(a,"event")):"object"==typeof r?(JSON.stringify(r).length>=255&&console.error("自定义事件参数不能超过255个字符"),a.ct=JSON.stringify(r),e(a,"event")):void 0===r||""===r?e(a,"event"):console.error("事件参数必须为String,Object类型,且参数长度不能超过255个字符")):console.error("事件名称必须为String类型且不能超过255个字符")},aldOnShareAppMessage:function(n){wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.onShareAppMessage(function(){var r=n(),a="",s="";a=void 0!==r.success?r.success:"",s=void 0!==r.fail?r.fail:"";var o="";o=void 0!==h.query.ald_share_src?void 0!==r.query?(h.query.ald_share_src.indexOf(i),r.query+"&ald_share_src="+h.query.ald_share_src+","+i):(h.query.ald_share_src.indexOf(i),"ald_share_src="+h.query.ald_share_src+","+i):void 0!==r.query?r.query+"&ald_share_src="+i:"ald_share_src="+i;var u=t(c);return r.query=o,u.ct=r,u.tp="ald_share_chain",e(u,"event"),r.success=function(t){u.tp="ald_share_status",e(u,"event"),""!==a&&a(t)},r.fail=function(t){u.tp="ald_share_fail",e(u,"event"),""!==s&&s(t)},r})}})},aldShareAppMessage:function(n){var r=n,a="",s="";a=void 0!==r.success?r.success:"",s=void 0!==r.fail?r.fail:"";var o="";o=void 0!==h.query.ald_share_src?void 0!==r.query?(h.query.ald_share_src.indexOf(i),r.query+"&ald_share_src="+h.query.ald_share_src+","+i):(h.query.ald_share_src.indexOf(i),"ald_share_src="+h.query.ald_share_src+","+i):void 0!==r.query?r.query+"&ald_share_src="+i:"ald_share_src="+i,r.query=o;var u=t(c);u.ct=r,u.tp="ald_share_chain",e(u,"event"),r.success=function(t){u.tp="ald_share_status",e(u,"event"),""!==a&&a(t)},r.fail=function(t){u.tp="ald_share_fail",e(u,"event"),""!==s&&s(t)},wx.updateShareMenu({withShareTicket:!0,complete:function(){wx.shareAppMessage(r)}})},aldSendSession:function(n){if(""!==n&&n){var r=t(c);r.tp="session",r.ct="session",u=n,""===v?wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){r.ufo=t,e(r,"event")}}):e(r,"event")}}):(r.ufo=v,""!==v&&(r.gid=""),e(r,"event"))}else console.error("请传入从后台获取的session_key")},aldSendOpenid:function(n){if(""!==n&&n){f=n;var r=t(c);r.tp="openid",r.ct="openid",e(r,"event")}else console.error("openID不能为空")}},q=0;q<x.length;q++)!function(e,t){Object.defineProperty(wx,e,{value:t,writable:!1,enumerable:!0,configurable:!0})}(x[q],m[x[q]]);try{var k=wx.getSystemInfoSync();c.br=k.brand||"",c.md=k.model,c.pr=k.pixelRatio,c.sw=k.screenWidth,c.sh=k.screenHeight,c.ww=k.windowWidth,c.wh=k.windowHeight,c.lang=k.language,c.wv=k.version,c.sv=k.system,c.wvv=k.platform,c.fs=k.fontSizeSetting,c.wsdk=k.SDKVersion,c.bh=k.benchmarkLevel||"",c.bt=k.battery||"",c.wf=k.wifiSignal||"",c.lng="",c.lat="",c.nt="",c.spd="",c.ufo=""}catch(e){}}();